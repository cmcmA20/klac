#+begin_src agda2

{-# OPTIONS --guardedness #-}
module homework.Day4 where


open import Day4

open import Data.Bool using (false; true) renaming (Bool to ğ”¹; _âˆ§_ to _&&_; _âˆ¨_ to _||_)
open import Data.List using (List; []; _âˆ·_; _++_; length)
open import Data.List.???
open import Data.List.???
open import Data.List.???
open import Data.Nat using (â„•; zero; suc; _+_) renaming (_â‰¤_ to _â‰¤â‚™_)

open import Structures.??? using (Â¬_; Reflects; yes; no)

#+end_src

* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 1 (â‹†â‹†)
ĞŸÑ€ĞµĞ´Ğ¿Ğ¾Ğ»Ğ°Ğ³Ğ°ĞµÑ‚ÑÑ, Ñ‡Ñ‚Ğ¾ Ğ²Ñ‹ Ğ·Ğ½Ğ°ĞºĞ¾Ğ¼Ñ‹ Ñ Ğ¿Ğ¾Ğ½ÑÑ‚Ğ¸ĞµĞ¼ /[[https://en.wikipedia.org/wiki/Partially_ordered_set][Ñ‡Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞ°]]/. 
ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚Ğµ /Ğ½ĞµÑƒĞ±Ñ‹Ğ²Ğ°ÑÑ‰Ğ¸Ğµ (Ğ¾Ñ‚ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ) ÑĞ¿Ğ¸ÑĞºĞ¸/.

#+begin_src agda2

record PartialOrder (A : Type â„“) : Type (suc-â„“ â„“) where
  field
    _â‰¤_ : Rel A â„“
    ipo : IsPartialOrder _â‰¡_ _â‰¤_
open PartialOrder â¦ƒ ... â¦„

-- Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ²ÑĞµ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ğ·Ğ° `t` ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ñ‹
nextElems : {A : Type â„“}
            {t : A} {xs : List A}
            (p : t âˆˆ xs) â†’ List A
nextElems {xs = _ âˆ· xsâ€²} (here  _) = xsâ€²
nextElems {xs = _ âˆ· _  } (there p) = nextElems p

-- Ğ½Ğ°Ğ¸Ğ²Ğ½Ğ¾Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾ÑÑ‚Ğ¸: ÑĞ¿Ğ¸ÑĞ¾Ğº `xs` Ğ¾Ñ‚ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½, ĞµÑĞ»Ğ¸ Ğ´Ğ»Ñ Ğ»ÑĞ±Ğ¾Ğ³Ğ¾
-- ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ° `t`, Ğ»ĞµĞ¶Ğ°Ñ‰ĞµĞ³Ğ¾ Ğ² `xs`, t Ğ¼ĞµĞ½ÑŒÑˆĞµ Ğ¸Ğ»Ğ¸ Ñ€Ğ°Ğ²ĞµĞ½ Ğ²ÑĞµĞ¼ Ğ¿Ğ¾ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¼ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼
is-sorted : {A : Type â„“}
            â¦ƒ po : PartialOrder A â¦„
            (xs : List A) â†’ Type â„“
is-sorted {_} {A} xs = {t : A} (p : t âˆˆ xs) â†’ All (t â‰¤_) (nextElems p)

-- Ğ´Ğ°Ğ²Ğ°Ğ¹Ñ‚Ğµ ÑĞ´ĞµĞ»Ğ°ĞµĞ¼ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ñ‚Ğ¸Ğ¿, ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸ ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾ Ğ±ÑƒĞ´ÑƒÑ‚ _Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾_ Ğ¾Ñ‚ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¿Ğ¸ÑĞºĞ¸
SortedList : (A : Type â„“) â¦ƒ po : PartialOrder A â¦„ â†’ Type â„“
SortedList A = {!!}

forget-naive : {A : Type â„“} â¦ƒ po : PartialOrder A â¦„ â†’
               SortedList A â†’ List A
forget-naive = {!!}

validate-naive : {A : Type â„“}
                 â¦ƒ po : PartialOrder A â¦„
                 (xsâ‚› : SortedList A) â†’ is-sorted (forget-naive xsâ‚›)
validate-naive = {!!}

#+end_src


* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 2 (â‹†â‹†â‹†â‹†)
Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚Ğµ Ğ¾Ñ‚ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¿Ğ¸ÑĞºĞ¸ Ñ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒÑ Ğ¸Ğ½Ğ´ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€ĞµĞ´Ğ¸ĞºĞ°Ñ‚Ğ°.

#+begin_src agda2

data IsSorted {A : Type â„“} â¦ƒ po : PartialOrder A â¦„ : List A â†’ Type â„“ where
  -- ĞºĞ°ĞºĞ¸Ğµ ĞµÑÑ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğµ ÑĞ»ÑƒÑ‡Ğ°Ğ¸ Ğ¾Ñ‚ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾ÑÑ‚Ğ¸ ÑĞ¿Ğ¸ÑĞºĞ¾Ğ²?

SortedListáµ¢ : (A : Type â„“) â¦ƒ po : PartialOrder A â¦„ â†’ Type â„“
SortedListáµ¢ A = {!!}

forgetáµ¢ : {A : Type â„“} â¦ƒ po : PartialOrder A â¦„ â†’
          SortedListáµ¢ A â†’ List A
forgetáµ¢ = {!!}

validateáµ¢ : {A : Type â„“}
            â¦ƒ po : PartialOrder A â¦„
            (xsâ‚› : SortedListáµ¢ A) â†’ is-sorted (forgetáµ¢ xsâ‚›)
validateáµ¢ = {!!}

#+end_src


* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 3 (â‹†â‹†â‹†â‹†â‹†)
ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ»Ğ¸ Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚ÑŒ Ğ¾Ñ‚ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¿Ğ¸ÑĞºĞ¸ ĞºĞ°Ğº Ğ¸Ğ½Ğ´ÑƒĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ñ‚Ğ¸Ğ¿?
Ğ”Ğ»Ñ Ğ²Ğ´Ğ¾Ñ…Ğ½Ğ¾Ğ²ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ğ¹Ñ‚Ğµ [[https://personal.cis.strath.ac.uk/conor.mcbride/Pivotal.pdf][How to keep your neighbours in order]].

#+begin_src agda2

data SortedListHard (A : Type â„“) : Type â„“ where
  -- hÌ·ÌÍ Ì“ÍŒÍÍŒÌˆÌ¾Ì˜Í™Ì³Í™Í‡Ì¥ÍœÌ¢eÌ¸Í‚Ì†ÌÌ†Í‚Í—Ì•Í€ÍŠÌ’ÍŠÌ„Í‹Ì„Ì§Ì³Ì­Í…Ì˜Ì¹ÌÌ©Ì Í‰Ì¥ÍÌ¡Ì¨Í” Ì·Ì‹ÌÌŠÍÌºÌ¯Í•cÌµÌŠÌÍ˜Í„ÌšÌƒÌ‚Ì‰ÍÍ†Í˜Ì†Ì¿Í—ÌœÌ¬Ì¢Ì¦ÍÌ¨ÌªÍ”Ì©Í•Í”ÌªoÌ¸ÍÌœÌ¡ÌºÌ»Ì«mÌ¶ÌÍƒÍ„Ì…Í—Í†Ì†Ì©Ì˜Ì»Ì¯ÍÌœÌ¥Ì§Ì¨Ì¥ÌªÌ©Ì®Í”eÌ¶Í‚Ì‰Ì‚Ì•Í„ÌšÍ‚ÌÌŒÍŠÍ’Ì¾ÌŒÍ€Í‰ÍšÌ™Ì«Í‡Ì©Ì»ÍœÌ©Ì¯sÌ¶ÍŠÌ³Ì£Ì¦Í”Ì§ÍÍ”Ì˜ÍÍ‡Ì®ÍÌ«Ì Íˆ

#+end_src


* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 4 (â‹†â‹†)
ĞŸĞ¾ĞºĞ°Ğ¶Ğ¸Ñ‚Ğµ, Ñ‡Ñ‚Ğ¾ ~reNotEmpty re~ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ /Ğ¾Ñ‚Ñ€Ğ°Ğ¶Ğ°ĞµÑ‚/ ÑĞ¸Ñ‚ÑƒĞ°Ñ†Ğ¸Ñ, Ğ² ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ»ÑĞ±Ğ°Ñ ÑÑ‚Ñ€Ğ¾ĞºĞ°, Ğ¼Ğ°Ñ‚Ñ‡Ğ°Ñ‰Ğ°ÑÑÑ
Ñ€ĞµĞ³ÑƒĞ»ÑÑ€ĞºĞ¾Ğ¹ ~re~.

#+begin_src agda2

reNotEmpty : {A : Type â„“} â†’ RegExp A â†’ ğ”¹
reNotEmpty Ã¸ = false
reNotEmpty Îµ = true
reNotEmpty (â€µ _) = true
reNotEmpty (reâ‚ âˆ™ reâ‚‚) = reNotEmpty reâ‚ && reNotEmpty reâ‚‚
reNotEmpty (reâ‚ âˆ£ reâ‚‚) = reNotEmpty reâ‚ || reNotEmpty reâ‚‚
reNotEmpty (_ +) = true

reNE-correct : {A : Type â„“} {s : List A} {re : RegExp A} â†’
               (s =~ re) â†’ reNotEmpty re â‰¡ true
reNE-correct = {!!}

#+end_src

* Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 5, [[https://en.wikipedia.org/wiki/Pumping_lemma_for_regular_languages][Ğ»ĞµĞ¼Ğ¼Ğ° Ğ¾ Ğ½Ğ°ĞºĞ°Ñ‡ĞºĞµ]] (â‹†â‹†â‹†â‹†â‹†)
Ğ•ÑĞ»Ğ¸ ÑÑ‚Ñ€Ğ¾ĞºĞ° ~s~ Ğ¼Ğ°Ñ‚Ñ‡Ğ¸Ñ‚ÑÑ Ñ€ĞµĞ³ÑƒĞ»ÑÑ€ĞºĞ¾Ğ¹, Ğ¸ Ğ´Ğ»Ğ¸Ğ½Ğ° ÑÑ‚Ñ€Ğ¾ĞºĞ¸ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ, Ñ‡ĞµĞ¼ Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ ĞºĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ğ°, Ñ‚Ğ¾ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ ~s~ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚
ÑÑƒÑ„Ñ„Ğ¸ĞºÑ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ½ĞµĞ²Ğ¾Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€ÑÑ‚ÑŒ, Ğ¸ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ñ‚Ğ¾Ğ¶Ğµ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¼Ğ°Ñ‚Ñ‡Ğ¸Ñ‚ÑŒÑÑ Ñ‚Ğ¾Ğ¹ Ğ¶Ğµ Ñ€ĞµĞ³ÑƒĞ»ÑÑ€ĞºĞ¾Ğ¹.

#+begin_src agda2

pumpingConstant : {A : Type â„“} â†’ RegExp A â†’ â„•
pumpingConstant Ã¸ = 0
pumpingConstant Îµ = 1
pumpingConstant (â€µ _) = 2
pumpingConstant (reâ‚ âˆ™ reâ‚‚) = pumpingConstant reâ‚ + pumpingConstant reâ‚‚
pumpingConstant (reâ‚ âˆ£ reâ‚‚) = pumpingConstant reâ‚ + pumpingConstant reâ‚‚
pumpingConstant (_ +) = 1

pump : {A : Type â„“} â†’ â„• â†’ List A â†’ List A
pump 0       xs = xs
pump (suc n) xs = xs ++ pump n xs

pumpingLemma : {A : Type â„“} {s : List A} {re : RegExp A} â†’ (s =~ re) â†’
               (pumpingConstant re â‰¤â‚™ length s) â†’
               Î£ _ Î» sâ‚ â†’ Î£ _ Î» sâ‚‚ â†’ Î£ _ Î» sâ‚ƒ â†’ (s â‰¡ sâ‚ ++ sâ‚‚ ++ sâ‚ƒ) Ã— (Â¬ (sâ‚‚ â‰¡ [])) Ã— ((m : â„•) â†’ sâ‚ ++ pump m sâ‚‚ ++ sâ‚ƒ =~ re)
pumpingLemma = {!!}

#+end_src
